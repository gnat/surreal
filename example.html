<!DOCTYPE html>
<html>
	<head>
		<title>Quick and Dirty Testing for Surreal</title>
		<!-- <script src="https://cdn.jsdelivr.net/gh/gnat/surreal/surreal.js"></script> -->
		<script src="surreal.js"></script> <!-- jsdeliver is taking too long to update -->
		<link rel="stylesheet" href="tests/reset.css?12" /> <!-- NOTE: You can remove "?11" it is only for cache-busting on github. -->
		<meta http-equiv="cache-control" content="no-cache" />
	</head>
	<body>
		<!-- Basic examples -->
		<button>ğŸ‘ï¸ Click me to fade out and remove.
			<script>
				me().on("click", ev => { me(ev).fadeOut() })
			</script>
		</button>
		<button class="invisible">ğŸ‘» Click me to fade in.
			<script>
				me().on("click", ev => { me(ev).fadeIn() })
			</script>
		</button>
		<button class="blue">ğŸ˜º Visit the source code for this page.
			<script>
				me().on("click", ev => { window.location.href ="https://github.com/gnat/surreal/blob/main/example.html" })
			</script>
		</button>
		<div class="yeet noot">I should be red.
			<script>
				any(".yeet.noot").classAdd('.active')
			</script>
		</div>
		<!-- Basic async examples -->
		<div id="random">I should turn grey after 2 seconds.
			<script>
				// Basic usage with id. Runs immediately.
				(async ()=>{
					me("#random").classAdd('active')
					await sleep(2000)
					me("#random").classAdd('inactive')
				})()
			</script>
		</div>
		<div>I should be animated using events.
			<script>
				// Now you're thinking with events!
				me().on("ping", async ev => {
					let el = me(ev)
					me(el).styles({"background":"hotpink", "color":"purple"})
					await sleep(1000)
					me(el).trigger("pong")
				})
				me().on("pong", async ev => {
					let el = me(ev)
					me(el).styles({"background":"blue", "color":"#002200"})
					await sleep(1000)
					me(el).trigger("ping")
				})
				me().styles({"transition":"all 2s"}).trigger("pong")
			</script>
		</div>
		<div>I should be animated using timeline / async until finished!
			<script>
				// Now you're thinking with async! Runs immediately.
				(async (el = me()) => {
					me(el).styles({"transition": "all 2s"})
					me(el).styles({"background":"#0030F7", "color":"#002200"})
					await sleep(2000)
					me(el).styles({"background":"#006BFF", "color":"#000033"})
					await sleep(2000)
					me(el).styles({"background":"#00A1FF", "color":"#005500"})
					await sleep(2000)
					me(el).styles({"background":"#00C08C", "color":"#660033"})
					await sleep(2000)

					// New element!
					var el_new = createElement("div")
					me(el_new).styles({"transition":"all 2s", "opacity":"0", "height":"0%"})
					el_new.innerText = "ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"
					me(el).appendChild(el_new)
					await sleep(1000)
					me(el_new).styles({"opacity":"1", "height":"fit-content"})
				})()
			</script>
		</div>
		<div>I should be surrounded by diamonds after a few seconds.
			<script>
				// Now you're thinking with async! Runs immediately.
				(async (el = me()) => {
					me(el).styles({"transition":"all 2s", "color":"#fff"})

					var el_new = createElement("div")
					el_new.innerText = "ğŸ’ğŸ’ğŸ’"
					me(el).prepend(el_new)
					me(el_new).styles({"transition":"all 2s", "opacity":"0"})
					await sleep(1000)
					me(el_new).styles({"opacity":"1"})
					await sleep(2000)

					var el_new = createElement("div")
					me(el_new).styles({"transition":"all 2s", "opacity":"0"})
					el_new.innerText = "ğŸ’ğŸ’ğŸ’"
					me(el).appendChild(el_new)
					await sleep(1000)
					me(el_new).styles({"opacity":"1"})
				})()
			</script>
		</div>
		<!-- Event examples -->
		<div thick>ğŸ“¬ I close from a child button event.
			<script>
				me().on("close", (ev) => { me(ev).fadeOut() }) // Recieve "close" event.
			</script>
			<button  class="close">âœ‰ï¸ Send "close"
				<script>
					me().on("click", (ev) => { me(ev).disabled = true; me(ev).trigger("close") })
				</script>
			</button>
		</div>
		<div thick>ğŸ“­ I stay open because of <strong>stopPropagation()</strong>
			<script>
				me().on("close", (ev) => { me(ev).fadeOut() }) // I will never recieve "close" event because of stopPropagation()
			</script>
			<div thick>ğŸ“¬ I close dramatically from a child button <strong>async</strong> event
				<script>
					me().on("close", async (ev) => {
						ev.stopPropagation() // Event stops here.
						let el = me(ev) // Save because event currentTarget will be lost after await
						me(el).styles({"transition":"all 1s", "background":"green"})
						await sleep(1000)
						me(el).styles({"background":"orange"})
						await sleep(1000)
						me(el).styles({"opacity":"0"})
						await sleep(1000)
						me(el).fadeOut()
					})
				</script>
				<button class="close">âœ‰ï¸ Send "close"
					<script>
						me().on("click", ev => { me(ev).disable(); me(ev).trigger("close"); }) // Use disable() to stop clicking more than once.
					</script>
				</button>
			</div>
		</div>
	</body>
</html>
